# 匿名用户精准广告投放生态系统

一个基于用户行为追踪与内容分类的匿名用户精准广告投放平台。该系统由一个中心化的广告管理网站和多个独立的媒体网站（购物、视频、新闻）组成，实现了跨域的精准广告投放与用户跟踪。

## 1. 团队成员组成与分工

| 成员 | 负责模块 | 核心工作内容 | 工作量占比 |
|------|----------|--------------|------------|
| 刘冰煜 (组长) | 视频网站子系统 | 流媒体播放、随机广告插播逻辑、Session 自动重置 | 25% |
| 彭淦扬 | 购物子系统 | B2C 电商流程、用户兴趣追踪、个性化推荐算法 | 25% |
| 杨振远 | 新闻网站子系统 | 新闻聚合管理、用户行为分析、滑动窗口推荐算法 | 25% |
| 庄子毅 | 广告网站子系统 | 广告资源中台、可视化分发平台、静态资源托管 | 25% |

## 2. 项目站点与文档

**GitHub 仓库地址**: https://github.com/1ceyyu/AdvertisementEcoSystem.git

## 3. 项目设计与规划

### 3.1 设计基本思路

系统核心是一个**中心辐射型模型**：

- **广告管理平台**：作为"大脑"，负责广告的创建、分类、投放策略制定和用户画像生成。
- **媒体网站**：作为"触手"，通过嵌入一个通用的 JavaScript SDK 来请求和展示广告。
- **精准投放**：
  - **内容分类**：各媒体网站通过在 HTML 的 `<meta>` 标签中声明自身内容分类。
  - **用户跟踪**：解决跨域问题，通过 CORS 和第三方Cookie 来追踪匿名用户的浏览兴趣，构建临时用户画像。
  - **视频插播**：视频网站采用服务器端 MIME类型混合响应 技术，将主体视频流与广告视频流在服务器端进行拼接，实现无缝插播。

### 3.2 技术选型

### 后端技术
- **核心框架**: Spring Boot 3.2.0 / Java Servlet
- **开发语言**: JDK 17 / 21
- **持久层**: Spring Data JPA / MySQL2
- **数据库**: MySQL 8.0
- **JSON处理**: Google Gson / Jackson

### 前端技术
- **框架/库**: React 19 / Vue-like Templates
- **渲染引擎**: Thymeleaf / JSP
- **构建工具**: Vite / Maven / npm
- **样式/交互**: Bootstrap 5 / Axios / JavaScript (ES6)

### 3.3 开发进度安排（共四周：11.18 - 12.15）

#### 第一周 (11.18 - 11.24)：基础框架搭建
- 项目立项与需求确认
- 技术栈统一与环境配置
- GitHub仓库初始化
- 数据库表结构设计
- 广告管理网站基础功能

#### 第二周 (11.25 - 12.01)：核心功能开发
- 广告管理网站：广告分类与投放策略配置
- 开发广告投放 JavaScript SDK
- 实现跨域用户跟踪逻辑
- 购物网站、新闻网站集成广告SDK

#### 第三周 (12.02 - 12.08)：高级功能与集成
- 视频分享网站：实现基于MIME的视频插播广告
- 完善精准投放算法
- 四个系统进行初步联调
- 编写API接口文档

#### 第四周 (12.09 - 12.15)：部署、测试与验收
- 将四个应用分别部署到4台服务器
- 进行端到端测试
- 压力测试与性能优化
- 项目总结与文档完善

## 📦 子系统核心功能

### 1. 视频分享网站 (VideoWebPlatform)
- **流媒体传输**: 实现 HTTP Range 请求，支持视频进度自由拖动与断点续传。
- **智能广告调度**: 采用 70% 概率算法，在 Pre-roll（前贴片）、Mid-roll（中插）和 Post-roll（后贴片）随机植入广告。
- **自动化运维**: 引入 SessionCounterListener，在全站无活跃用户时自动重置点击量统计。

### 2. 个性化推荐购物网站 (Shopping)
- **双轨推荐策略**:
    - 左侧精准: 基于用户点击频次计算“Top Interest”，匹配对应分类广告。
    - 右侧随机: 展示全量广告资源，保证推荐多样性。
- **时效性控制**: 具备“3分钟自动重置”机制，防止过往数据固化推荐结果。
- **电商基础**: 支持价格筛选、模糊搜索及具备事务性的购物车结账流程。

### 3. 用户行为分析新闻系统 (News)
- **滑动窗口算法**: 基于用户最近 10 次点击行为，实时构建用户短期兴趣画像。
- **异构系统映射**: 建立本地英文分类（如 Tech）与外部广告中文分类（如 AI）的映射。
- **UI/UX**: 采用 7:3 黄金比例布局，侧边栏广告位实现 Sticky 悬浮滚动效果。

### 4. 广告素材分发平台 (AdFlux)
- **资源可视化**: 以卡片形式展示广告，自动识别渲染视频或图片格式。
- **动态路径映射**: 自动拼接服务器 Host，生成可供外部调用的 API Resource 链接。
- **跨域支持**: 通过 CORS 中间件及 Vite Proxy 解决前后端分离的跨域限制。

## 🚀 快速启动

### 环境要求
- MySQL 8.0+
- Maven 3.6+
- Node.js 18+ (用于广告子系统)

### 数据库配置
1. 创建名为 `web_app` 的数据库。
2. 运行各模块 `resources/sql` 目录下的初始化脚本。

### 编译运行

```bash
# 对于 Spring Boot 模块 (Shopping/News)
mvn clean package
java -jar target/*.war

# 对于 React 模块 (AdFlux)
cd advertisement-ecosystem-frontend
npm install
npm run dev
```
## ⚠️ 常见问题解决 (Troubleshooting)

| 问题 | 解决方案 |
|------|----------|
| **图片 404** | 商品/视频封面存储在物理磁盘。需在 Tomcat `server.xml` 中配置 `<Context docBase="/path/to/images" path="/uploads"/>`。 |
| **视频拖拽失败** | 确保服务器支持 `Accept-Ranges` 响应头，代码中使用 `RandomAccessFile` 分段读取字节流。 |
| **接口跨域** | 后端已统一配置 `Access-Control-Allow-Origin: *`。 |
